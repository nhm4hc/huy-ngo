C51 COMPILER V9.60.0.0   MAIN                                                              11/10/2023 01:45:35 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /**************************************************************************************
   2          深圳市普中科技有限公司（PRECHIN 普中）
   3          技术支持：www.prechin.net
   4          
   5          实验名称：独立按键实验
   6          接线说明：  
   7          实验现象：下载程序后，按下“独立按键”模块中K1键，控制D1指示灯亮灭
   8          注意事项：                                          
   9          ***************************************************************************************/
  10          #include "reg52.h"
  11          
  12          typedef unsigned int u16; 
  13          typedef unsigned char u8;
  14          
  15          
  16          sbit KEY1=P3^1;
  17          sbit KEY2=P3^0;
  18          sbit KEY3=P3^2;
  19          sbit KEY4=P3^3;
  20          
  21          
  22          sbit LED1=P2^0;
  23          #define LED P0
  24          
  25          
  26          #define KEY1_PRESS  1
  27          #define KEY2_PRESS  2
  28          #define KEY3_PRESS  3
  29          #define KEY4_PRESS  4
  30          #define KEY_UNPRESS 0 
  31          
  32          
  33          // hexa led 7 doan
  34          unsigned char code veee[]={0x3F, 0x06, 0x5B, 0x4F, 0x66, 0x6D, 0x7D, 0x07, 0x7F, 0x6F};
  35          
  36          
  37          void delay_10us(u16 ten_us)
  38          {
  39   1        while(ten_us--);  
  40   1      }
  41          
  42          
  43          u8 key_scan(u8 mode)
  44          {
  45   1        static u8 key=1;
  46   1      
  47   1        if(mode)key=1;//连续扫描按键
  48   1        if(key==1&&(KEY1==0||KEY2==0||KEY3==0||KEY4==0))//任意按键按下
  49   1        {
  50   2          delay_10us(1000);//消抖
  51   2          key=0;
  52   2          if(KEY1==0)
  53   2            return KEY1_PRESS;
  54   2          else if(KEY2==0)
C51 COMPILER V9.60.0.0   MAIN                                                              11/10/2023 01:45:35 PAGE 2   

  55   2            return KEY2_PRESS;
  56   2          else if(KEY3==0)
  57   2            return KEY3_PRESS;
  58   2          else if(KEY4==0)
  59   2            return KEY4_PRESS;  
  60   2        }
  61   1        else if(KEY1==1&&KEY2==1&&KEY3==1&&KEY4==1) //无按键按下
  62   1        {
  63   2          key=1;      
  64   2        }
  65   1        return KEY_UNPRESS;   
  66   1      }
  67          /*******************************************************************************
  68          * 函 数 名       : main
  69          * 函数功能     : 主函数
  70          * 输    入       : 无
  71          * 输    出       : 无
  72          *******************************************************************************/
  73          
  74          
  75          void delayMS(unsigned int t)
  76          {
  77   1        int i,j;
  78   1        for(i = 0; i < t; i++){
  79   2          for( j = 0; j < 123; j++) {}
  80   2      }
  81   1        }
  82          void dichLedGiamDan()
  83          {
  84   1          int i;
  85   1          for(i = 10; i > 0; i--)
  86   1          {
  87   2              LED = veee[i-1];
  88   2              delayMS(500);
  89   2          }
  90   1          LED = 0;
  91   1          delayMS(200);
  92   1      }
  93          
  94          void dichLedTangDan()
  95          {
  96   1          int i, j;
  97   1          for(i = 0; i < 10; i++)
  98   1          {
  99   2              //LED = (1 << i); // Shift a single LED to the left
 100   2              //delayMS(500);
 101   2              LED = veee[i+1];
 102   2            delayMS(500);
 103   2          }
 104   1          LED = 0;
 105   1          delayMS(500);
 106   1      }
*** WARNING C280 IN LINE 96 OF main.c: 'j': unreferenced local variable
 107          
 108          
 109          void main()
 110          { 
 111   1        u8 key=0;
 112   1      
 113   1        while(1)
 114   1        {
 115   2            key=key_scan(0);
C51 COMPILER V9.60.0.0   MAIN                                                              11/10/2023 01:45:35 PAGE 3   

 116   2          if(KEY1 == 0){
 117   3          dichLedGiamDan();
 118   3            while(KEY1 == 0);
 119   3        }   
 120   2        else if(KEY2 == 0){
 121   3          dichLedTangDan();
 122   3          while(KEY2 == 0);
 123   3        }   
 124   2      }
 125   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    256    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
